(print "
// simple type(n) functions")

(define testcase "
PUBLIC
void v_cc..c(n)(type a1, type a2, .., type an)
{
   printf('{{ %d %d .. %d(n) }}', a1, a2, .., an); fflush(stdout);
}")
(print "/*" testcase "*/")

(for-each (lambda (index typename format)
      (for-each (lambda (n) (print
            (fold (lambda (testcase pair)
                     (str-replace testcase (car pair) (cdr pair)))
               (s/'/"/g testcase)
               (list
                  (~~ '|v_cc..c(n)| index n) ; function name
                  (~~ '|type a1, type a2, .., type an| typename n) ; function args
                  (~~ '|%d %d .. %d(n)| format n)
                  (~~ '|a1, a2, .., an| n)
               )) ))

         ;(iota (if (m/Q|q/ index) (/ MAX-ARGS-COUNT 2) MAX-ARGS-COUNT) 1)))
         (iota MAX-ARGS-COUNT 1)))
   ; unsigned types                                                      ; signed types                                          ; floating points
   '("C"             "S"              "I"             "Q"                  "c"            "s"            "i"           "q"         "f"     "d"     )
   '("unsigned char" "unsigned short" "unsigned int"  "unsigned long long" "signed char"  "signed short" "signed int"  "long long" "float" "double")
   '("%u"            "%u"             "%u"            "%llu"               "%d"           "%d"           "%d"          "%lld"      "%f"    "%f"    ))

